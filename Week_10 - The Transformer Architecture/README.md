# ðŸŽ¯ Goals for week 10

1. Implement an encoder-decoder Transformer.
2. Practice writing high quality code:
   1. Easy to read.
   2. Safe from bugs.
   3. Ready for change.

## Task 01

**Description:**

Define a transformer with `8` attention heads, `6` encoder and decoder layers, and for input sequence embeddings of length `1536`. Output the model object to show the model architecture.

**Acceptance criteria:**

1. A Transformer is created using a built-in class.
2. The test case passes.

**Test case:**

```console
python task01.py
```

```console
Transformer(
  (encoder): TransformerEncoder(
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=1536, out_features=1536, bias=True)
        )
        (linear1): Linear(in_features=1536, out_features=2048, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=2048, out_features=1536, bias=True)
        (norm1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=1536, out_features=1536, bias=True)
        )
        (multihead_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=1536, out_features=1536, bias=True)
        )
        (linear1): Linear(in_features=1536, out_features=2048, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=2048, out_features=1536, bias=True)
        (norm1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
        (dropout3): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
  )
)
```

## Task 02

**Description:**

Define a class `InputEmbeddings` that can encode `10,000` tokens into `512`-dimensional vectors.

Apply it on the following input and show the output's shape and the embedding of the first token.

```python
token_ids = torch.tensor([[1, 2, 3, 4], [5, 6, 7, 8]])
```

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. An input embedding is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.

**Test case:**

```console
python task02.py
```

```console
Shape of output: torch.Size([2, 4, 512])
Embedding of first token: tensor([-29.7585,  -1.5320,  -3.0543, -11.7277,   5.2621,  36.9068, -19.7024,
          1.1091,  -5.7159,   1.8338,  28.7414,  16.7375,  24.6407, -14.9143,
         -4.3227,  11.4514,  40.2486, -16.0469, -34.5345, -33.2455,  72.5264,
         -6.2573,  -1.2220,  15.0982, -11.3665, -24.9873,  19.7784, -33.3697,
         -1.7752, -20.8495, -27.1865,  -3.7119,  25.7179, -16.5864,  30.2809,
          6.1220,  11.4742,   0.3861,  -6.9708, -26.4641,  -9.6485, -20.9665,
          9.2181,  -1.4408, -31.9163, -26.4945, -24.7647,  -8.3727,  -0.0832,
         14.2537,  11.7048,  13.6467, -22.7297,   4.4323,  32.7201, -55.6621,
        -16.1116, -39.4413,   1.1559,  -6.2625, -13.9900,  10.1023,  45.5336,
        -52.6108,  28.7381, -11.9389,  21.9032,  13.7663,   4.9452, -44.5905,
        -15.0232,  -0.5866,  28.7974, -18.0050,   2.6966, -18.4220,   3.0125,
          4.8027, -19.9902,   6.5366,   4.6368,  19.9776, -21.6073, -19.5977,
         36.0587,  38.1529,  -7.7735,  16.5344,  13.2635,  14.4091, -21.1238,
        -12.5740,  -4.3704,  -3.6633, -34.2731, -55.4303, -33.4379,  13.5223,
         -1.1283,  -7.8512,  -8.8048,  42.8758,   4.6932,   9.4659,  14.6143,
        -21.2894,  -5.6484, -17.5059,   1.7041,  11.8412,  15.6611,   4.9840,
        -16.8916,   5.0464,   0.2251, -14.4334, -38.8943,  32.8271,  21.2031,
        -41.6533,  12.5337,  43.3777, -13.7430, -16.3388,  57.3104, -28.6661,
         26.8866,   2.7629, -25.0370,  28.6968,   7.1197, -22.6045, -11.9889,
        -25.4726, -35.8391,   2.9377,  42.1359, -16.8475,   8.1163,  19.5117,
         20.7159,  24.6284,  16.5404, -12.3744, -40.7849, -11.8295,  18.4424,
         -3.1644,  15.7504,   6.9601, -25.8851, -12.1223,  -7.1028,  16.0071,
        -22.2798,   5.2601, -11.5598, -23.8716,   1.7994,  27.7337,  39.5976,
         -4.5922, -15.5098,  32.2888,  -7.3596,  15.8680,  -2.8552, -29.2617,
         10.9933,  26.4579,   4.9495, -21.5847,  27.1617,  61.1840,   0.5942,
         11.8184,   6.8823, -26.1007, -38.4629,  15.9819,  -5.4510,   7.7299,
        -30.9505, -25.3766,  -8.0396,   7.6134,  -2.3658,  -9.3770,  -9.0279,
         10.1050, -20.2966,   2.2822,   5.3035, -45.1953, -29.6070,  -0.6848,
         -4.4562, -35.6545,   0.9710, -29.6781,  12.8074, -26.1750, -21.4090,
        -18.6798,   6.0818,   1.4804,   8.5436,  -7.7523,  12.7727,  23.7027,
         49.5719, -15.3754,  -4.9656,  24.1539,  -2.7429,   6.5723,  24.6985,
         47.4025, -40.6604, -17.4845,  17.9730,   1.0917, -13.5104,  16.7260,
         -2.0898,  -3.2531,  18.7542, -30.6544,  20.8217,   3.9441, -10.8512,
         -1.6648,  -0.9470,  -1.2108,  27.4451,   2.7254,  16.9774,  -2.2942,
         31.5399,  -8.7147,   5.3491,  20.8418,   2.9770,  10.8673, -25.5511,
         24.2558,  25.0116, -46.5798,   6.5116, -25.7700,   3.9117,  21.8263,
         18.4028,  -7.1983, -31.5330,  11.8256,   5.8349,   7.7378, -18.4817,
         37.9504, -18.9006,  17.0415,   1.8574,  26.3620, -15.0141, -17.6688,
         -5.1359,  -9.8607,  18.5753, -14.3763,  -9.9239, -10.1201,  34.1638,
         -1.7723,  17.4385,  11.7211,   5.5610,   8.9081, -17.8356,   7.3037,
        -16.8501,   7.0195, -33.0792,  -3.9492, -12.4048,  -9.2706,  -1.4197,
          0.3953,  31.0336,  -5.0378,  23.9081,   8.3421,  41.5415,  29.3176,
         18.2028, -14.0019, -26.6899,   7.6548,  21.0862,  16.8259,   5.6342,
        -31.2575, -18.0672,  14.4121, -35.1413, -36.8650,  13.8188,  28.7779,
        -21.3188,  -6.0357,  -7.2779,  10.1919,   8.4129,  14.6110,  13.1334,
          8.4895,   9.7129, -16.4627, -12.5066,  14.0045, -32.3201,  12.7087,
         17.4255,   8.0693,  -2.8678,  21.3760,   3.3181,   6.0479,  21.4222,
         -3.1814,   0.7435, -48.7430,  31.5713,  26.8030,  -2.8404,   5.6942,
         29.5979,   3.3838,  25.6034,   4.6258,  28.1270,  -0.9262,  16.9493,
          6.8474, -17.1758, -21.5911, -36.5668,  -2.2993, -26.0442, -41.2149,
         26.3716, -52.7374,  11.4536, -34.7630, -13.8615,  38.7084,   6.9553,
         11.7617,  18.0983,  42.4875,  23.3845,   6.8770,  22.6996,   6.4814,
          2.4246,   7.4932,   9.1544,  29.7064,  -2.5937, -29.8130,  16.0086,
          5.7597,  -6.5396,  -4.8443,  30.8642, -13.7508,  23.4983, -49.4736,
          3.3504, -19.1815,  17.4893, -30.7139, -26.5765, -11.5998,   3.5777,
         20.5107, -41.7281,   4.3692, -48.8849,   5.2804,   0.4861,  42.2847,
          0.6365,   5.0782,  30.5444,   4.6193,  12.7664, -10.1332, -22.5422,
         12.2599, -14.1985,   5.6465,  14.1219,  32.9376,  30.2804,  -2.7037,
         25.4789,   6.2272, -16.4246,  10.0101,   2.5051,  16.5509,  -5.3302,
         61.5765, -23.1225,  11.0392, -41.3581, -14.5705,  18.5307,   0.9182,
         13.0106,  -8.9994, -22.2943, -13.9907,  37.2299,   4.5012, -26.6634,
          0.1506,  13.6049, -19.3432,  11.6595,  12.0133, -12.4869,  19.5970,
          3.8460,  44.7983, -27.3770,   1.6130,  18.6860,  -0.5926,  22.5234,
         53.1122,  -2.5404,  -8.2858, -23.7794, -15.2391, -13.0401, -21.0235,
        -17.5797, -31.1299,  -0.9840,  66.9112, -28.1762,  17.3499, -30.3137,
        -13.1691,  75.0020, -17.8242,   1.4963,  67.7828,   3.8089,  -3.4556,
          0.2967,  -5.2298,  24.7874, -12.7758,  20.2924, -10.4120,  35.6871,
         62.0738,  63.2288, -17.5947,   8.8316,  -7.5371, -21.0168,  -6.7385,
          4.7280,  -7.3658,  13.2677, -13.8512, -61.0264,  -5.6877, -20.1770,
         18.6802,  21.7048, -35.6451, -15.4166,  -9.4611,   5.8211,  15.6959,
          9.5188,  24.0897,  -0.5046,  13.1973, -27.5199, -23.7867,  -9.7312,
         21.1321, -10.6853,  19.2558,   4.5039,  17.6202, -15.8350,   0.8767,
        -41.4365,  -1.1694,  -0.7806, -14.6271,  -8.1019, -10.9509,  -6.1383,
         -1.7513], grad_fn=<SelectBackward0>)
```

## Task 03

**Description:**

Define a class `PositionalEncoding` that can positionally encode sequences of `4` token IDs into `512`-dimensional vectors.

Apply it on the output of `Task 2` and print the shape of the result and the encoding of the first token embedding.

Set the seed of PyTorch to `123`.

In the `__init__` we'll have to create a vector with the values of the sine and cosine functions. We'll need to use this vector in the `forward` call to add it to the received embeddings. If we store the vector with the positional encodings directly in `self`, PyTorch will treat it as a set of learnable parameters. One way to turn this off is the using the function [`register_buffer`](https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.register_buffer). It's used to tell PyTorch to not consider a set of numbers a learnable parameter.

The goal is to have something like this:

```python
def __init__(self, d_model, max_seq_length):
    super().__init__()
    # create "pe" here (don't store it in self explicitly)
    self.register_buffer('pe', pe.unsqueeze(0)) # use "register_buffer" to put it in self

def forward(self, x):
    return x + self.pe[:, :x.size(1)] # use as if it was in self
```

**Acceptance criteria:**

1. Positional encoding is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.

**Test case:**

```console
python task03.py
```

```console
Shape of output: torch.Size([2, 4, 512])
Encoding of first token embedding: tensor([-2.9758e+01, -5.3198e-01, -3.0543e+00, -1.0728e+01,  5.2621e+00,
         3.7907e+01, -1.9702e+01,  2.1091e+00, -5.7159e+00,  2.8338e+00,
         2.8741e+01,  1.7738e+01,  2.4641e+01, -1.3914e+01, -4.3227e+00,
         1.2451e+01,  4.0249e+01, -1.5047e+01, -3.4534e+01, -3.2246e+01,
         7.2526e+01, -5.2573e+00, -1.2220e+00,  1.6098e+01, -1.1367e+01,
        -2.3987e+01,  1.9778e+01, -3.2370e+01, -1.7752e+00, -1.9850e+01,
        -2.7187e+01, -2.7119e+00,  2.5718e+01, -1.5586e+01,  3.0281e+01,
         7.1220e+00,  1.1474e+01,  1.3861e+00, -6.9708e+00, -2.5464e+01,
        -9.6485e+00, -1.9967e+01,  9.2181e+00, -4.4082e-01, -3.1916e+01,
        -2.5495e+01, -2.4765e+01, -7.3727e+00, -8.3172e-02,  1.5254e+01,
         1.1705e+01,  1.4647e+01, -2.2730e+01,  5.4323e+00,  3.2720e+01,
        -5.4662e+01, -1.6112e+01, -3.8441e+01,  1.1559e+00, -5.2625e+00,
        -1.3990e+01,  1.1102e+01,  4.5534e+01, -5.1611e+01,  2.8738e+01,
        -1.0939e+01,  2.1903e+01,  1.4766e+01,  4.9452e+00, -4.3591e+01,
        -1.5023e+01,  4.1338e-01,  2.8797e+01, -1.7005e+01,  2.6966e+00,
        -1.7422e+01,  3.0125e+00,  5.8027e+00, -1.9990e+01,  7.5366e+00,
         4.6368e+00,  2.0978e+01, -2.1607e+01, -1.8598e+01,  3.6059e+01,
         3.9153e+01, -7.7735e+00,  1.7534e+01,  1.3264e+01,  1.5409e+01,
        -2.1124e+01, -1.1574e+01, -4.3704e+00, -2.6633e+00, -3.4273e+01,
        -5.4430e+01, -3.3438e+01,  1.4522e+01, -1.1283e+00, -6.8512e+00,
        -8.8048e+00,  4.3876e+01,  4.6932e+00,  1.0466e+01,  1.4614e+01,
        -2.0289e+01, -5.6484e+00, -1.6506e+01,  1.7041e+00,  1.2841e+01,
         1.5661e+01,  5.9840e+00, -1.6892e+01,  6.0464e+00,  2.2508e-01,
        -1.3433e+01, -3.8894e+01,  3.3827e+01,  2.1203e+01, -4.0653e+01,
         1.2534e+01,  4.4378e+01, -1.3743e+01, -1.5339e+01,  5.7310e+01,
        -2.7666e+01,  2.6887e+01,  3.7629e+00, -2.5037e+01,  2.9697e+01,
         7.1197e+00, -2.1605e+01, -1.1989e+01, -2.4473e+01, -3.5839e+01,
         3.9377e+00,  4.2136e+01, -1.5848e+01,  8.1163e+00,  2.0512e+01,
         2.0716e+01,  2.5628e+01,  1.6540e+01, -1.1374e+01, -4.0785e+01,
        -1.0830e+01,  1.8442e+01, -2.1644e+00,  1.5750e+01,  7.9601e+00,
        -2.5885e+01, -1.1122e+01, -7.1028e+00,  1.7007e+01, -2.2280e+01,
         6.2601e+00, -1.1560e+01, -2.2872e+01,  1.7994e+00,  2.8734e+01,
         3.9598e+01, -3.5922e+00, -1.5510e+01,  3.3289e+01, -7.3596e+00,
         1.6868e+01, -2.8552e+00, -2.8262e+01,  1.0993e+01,  2.7458e+01,
         4.9495e+00, -2.0585e+01,  2.7162e+01,  6.2184e+01,  5.9418e-01,
         1.2818e+01,  6.8823e+00, -2.5101e+01, -3.8463e+01,  1.6982e+01,
        -5.4510e+00,  8.7299e+00, -3.0951e+01, -2.4377e+01, -8.0396e+00,
         8.6134e+00, -2.3658e+00, -8.3770e+00, -9.0279e+00,  1.1105e+01,
        -2.0297e+01,  3.2822e+00,  5.3035e+00, -4.4195e+01, -2.9607e+01,
         3.1517e-01, -4.4562e+00, -3.4655e+01,  9.7102e-01, -2.8678e+01,
         1.2807e+01, -2.5175e+01, -2.1409e+01, -1.7680e+01,  6.0818e+00,
         2.4804e+00,  8.5436e+00, -6.7523e+00,  1.2773e+01,  2.4703e+01,
         4.9572e+01, -1.4375e+01, -4.9656e+00,  2.5154e+01, -2.7429e+00,
         7.5723e+00,  2.4699e+01,  4.8402e+01, -4.0660e+01, -1.6484e+01,
         1.7973e+01,  2.0917e+00, -1.3510e+01,  1.7726e+01, -2.0898e+00,
        -2.2531e+00,  1.8754e+01, -2.9654e+01,  2.0822e+01,  4.9441e+00,
        -1.0851e+01, -6.6485e-01, -9.4696e-01, -2.1077e-01,  2.7445e+01,
         3.7254e+00,  1.6977e+01, -1.2942e+00,  3.1540e+01, -7.7147e+00,
         5.3491e+00,  2.1842e+01,  2.9770e+00,  1.1867e+01, -2.5551e+01,
         2.5256e+01,  2.5012e+01, -4.5580e+01,  6.5116e+00, -2.4770e+01,
         3.9117e+00,  2.2826e+01,  1.8403e+01, -6.1983e+00, -3.1533e+01,
         1.2826e+01,  5.8349e+00,  8.7378e+00, -1.8482e+01,  3.8950e+01,
        -1.8901e+01,  1.8041e+01,  1.8574e+00,  2.7362e+01, -1.5014e+01,
        -1.6669e+01, -5.1359e+00, -8.8607e+00,  1.8575e+01, -1.3376e+01,
        -9.9239e+00, -9.1201e+00,  3.4164e+01, -7.7226e-01,  1.7439e+01,
         1.2721e+01,  5.5610e+00,  9.9081e+00, -1.7836e+01,  8.3037e+00,
        -1.6850e+01,  8.0195e+00, -3.3079e+01, -2.9492e+00, -1.2405e+01,
        -8.2706e+00, -1.4197e+00,  1.3953e+00,  3.1034e+01, -4.0378e+00,
         2.3908e+01,  9.3421e+00,  4.1541e+01,  3.0318e+01,  1.8203e+01,
        -1.3002e+01, -2.6690e+01,  8.6548e+00,  2.1086e+01,  1.7826e+01,
         5.6342e+00, -3.0258e+01, -1.8067e+01,  1.5412e+01, -3.5141e+01,
        -3.5865e+01,  1.3819e+01,  2.9778e+01, -2.1319e+01, -5.0357e+00,
        -7.2779e+00,  1.1192e+01,  8.4129e+00,  1.5611e+01,  1.3133e+01,
         9.4895e+00,  9.7129e+00, -1.5463e+01, -1.2507e+01,  1.5004e+01,
        -3.2320e+01,  1.3709e+01,  1.7425e+01,  9.0693e+00, -2.8678e+00,
         2.2376e+01,  3.3181e+00,  7.0479e+00,  2.1422e+01, -2.1814e+00,
         7.4352e-01, -4.7743e+01,  3.1571e+01,  2.7803e+01, -2.8404e+00,
         6.6942e+00,  2.9598e+01,  4.3838e+00,  2.5603e+01,  5.6258e+00,
         2.8127e+01,  7.3844e-02,  1.6949e+01,  7.8474e+00, -1.7176e+01,
        -2.0591e+01, -3.6567e+01, -1.2993e+00, -2.6044e+01, -4.0215e+01,
         2.6372e+01, -5.1737e+01,  1.1454e+01, -3.3763e+01, -1.3862e+01,
         3.9708e+01,  6.9553e+00,  1.2762e+01,  1.8098e+01,  4.3487e+01,
         2.3384e+01,  7.8770e+00,  2.2700e+01,  7.4814e+00,  2.4246e+00,
         8.4932e+00,  9.1544e+00,  3.0706e+01, -2.5937e+00, -2.8813e+01,
         1.6009e+01,  6.7597e+00, -6.5396e+00, -3.8443e+00,  3.0864e+01,
        -1.2751e+01,  2.3498e+01, -4.8474e+01,  3.3504e+00, -1.8181e+01,
         1.7489e+01, -2.9714e+01, -2.6576e+01, -1.0600e+01,  3.5777e+00,
         2.1511e+01, -4.1728e+01,  5.3692e+00, -4.8885e+01,  6.2804e+00,
         4.8614e-01,  4.3285e+01,  6.3652e-01,  6.0782e+00,  3.0544e+01,
         5.6193e+00,  1.2766e+01, -9.1332e+00, -2.2542e+01,  1.3260e+01,
        -1.4198e+01,  6.6465e+00,  1.4122e+01,  3.3938e+01,  3.0280e+01,
        -1.7037e+00,  2.5479e+01,  7.2272e+00, -1.6425e+01,  1.1010e+01,
         2.5051e+00,  1.7551e+01, -5.3302e+00,  6.2576e+01, -2.3123e+01,
         1.2039e+01, -4.1358e+01, -1.3570e+01,  1.8531e+01,  1.9182e+00,
         1.3011e+01, -7.9994e+00, -2.2294e+01, -1.2991e+01,  3.7230e+01,
         5.5012e+00, -2.6663e+01,  1.1506e+00,  1.3605e+01, -1.8343e+01,
         1.1659e+01,  1.3013e+01, -1.2487e+01,  2.0597e+01,  3.8460e+00,
         4.5798e+01, -2.7377e+01,  2.6130e+00,  1.8686e+01,  4.0737e-01,
         2.2523e+01,  5.4112e+01, -2.5404e+00, -7.2858e+00, -2.3779e+01,
        -1.4239e+01, -1.3040e+01, -2.0024e+01, -1.7580e+01, -3.0130e+01,
        -9.8395e-01,  6.7911e+01, -2.8176e+01,  1.8350e+01, -3.0314e+01,
        -1.2169e+01,  7.5002e+01, -1.6824e+01,  1.4963e+00,  6.8783e+01,
         3.8089e+00, -2.4556e+00,  2.9673e-01, -4.2298e+00,  2.4787e+01,
        -1.1776e+01,  2.0292e+01, -9.4120e+00,  3.5687e+01,  6.3074e+01,
         6.3229e+01, -1.6595e+01,  8.8316e+00, -6.5371e+00, -2.1017e+01,
        -5.7385e+00,  4.7280e+00, -6.3658e+00,  1.3268e+01, -1.2851e+01,
        -6.1026e+01, -4.6877e+00, -2.0177e+01,  1.9680e+01,  2.1705e+01,
        -3.4645e+01, -1.5417e+01, -8.4611e+00,  5.8211e+00,  1.6696e+01,
         9.5188e+00,  2.5090e+01, -5.0460e-01,  1.4197e+01, -2.7520e+01,
        -2.2787e+01, -9.7312e+00,  2.2132e+01, -1.0685e+01,  2.0256e+01,
         4.5039e+00,  1.8620e+01, -1.5835e+01,  1.8767e+00, -4.1436e+01,
        -1.6944e-01, -7.8060e-01, -1.3627e+01, -8.1019e+00, -9.9509e+00,
        -6.1383e+00, -7.5134e-01], grad_fn=<SelectBackward0>)
```

## Task 04

**Description:**

Create a class `Head` to represent a single attention head.

Apply it on the output of `Task 3`. Print the shape of the result and the output for the first element in the first batch.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. A single self-attention head is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. An appropriate value is set for the parameter `head_size`.
5. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task04.py
```

```console
k.shape=torch.Size([2, 4, 512])
q.shape=torch.Size([2, 4, 512])
v.shape=torch.Size([2, 4, 512])
attention_scores.shape=torch.Size([2, 4, 4])
Sum before softmax of first row of attention scores in the first batch: 4498.56005859375
Sum after softmax of first row of attention scores in the first batch: 1.0
Shape of output of head: torch.Size([2, 4, 512])
Output for the first element in the first batch: tensor([ 1.6017e+01, -9.0762e+01, -1.3353e+01,  1.4055e+01, -1.0558e+01,
         2.2891e+01, -6.0870e+00,  7.3265e+00, -7.6274e+00, -1.1401e+01,
         9.9919e+00,  2.5546e+01,  1.1190e+01, -9.1676e+00,  1.1628e+01,
        -8.6133e+00,  7.6473e-01,  2.2487e+01, -1.6187e+01, -1.5651e+01,
        -1.6403e+01,  2.0942e+01, -8.7947e+00,  3.4690e+00, -7.8235e+00,
         4.3748e+00,  1.3202e+01,  1.3428e+01,  1.3483e+01,  1.1599e+01,
         4.1695e+00,  1.0569e+01, -2.4895e+01, -2.3851e+01,  1.2439e+01,
         1.8178e+00,  1.1711e+01,  2.1696e+01, -3.2923e+00,  6.3461e+00,
         3.9018e+00, -1.4333e+01,  2.0108e+01,  9.7682e-01,  7.6270e+00,
        -1.8827e+01, -1.0849e+01,  2.3906e+01,  1.2442e+01, -1.5889e+01,
         1.1622e+01,  2.1001e+00,  6.8068e-01,  4.4641e+00, -3.2620e+01,
        -2.7368e+00, -3.5377e+01,  7.3502e+00, -1.7435e+01, -8.5467e+00,
        -1.4090e+00,  1.1692e+00, -3.8689e+01,  2.2900e+00, -1.3076e+01,
         7.5516e+00, -1.0223e+01,  7.8519e+00,  7.0287e+00,  2.2716e+01,
        -9.8524e+00,  1.4175e+00,  1.2269e+01, -3.5452e+00, -5.0049e+00,
         1.2787e+01,  1.6241e+00,  7.0464e+00, -1.2009e+01,  2.8812e+01,
         1.3443e+01, -2.1367e+00,  2.0536e+01, -2.8311e+00, -1.8094e+01,
         1.7600e+01,  6.6706e+00, -7.7071e+00,  2.6086e-01,  4.6976e+00,
         1.6891e+01, -1.0164e+01,  9.7596e+00,  2.1778e-01,  5.7806e+00,
         9.1204e+00,  7.1267e+00,  8.0488e-01, -9.9310e-02, -7.8639e+00,
        -1.2560e+01,  2.9135e+00, -1.2889e+01,  3.7150e+00,  1.0698e+01,
        -6.7787e+00, -4.2087e+00,  1.9467e+01,  2.7918e+01, -1.3778e-02,
         6.4304e+00, -9.1383e+00, -2.2031e+01,  9.6836e+00, -1.7022e-01,
        -6.5175e+00, -2.0230e+01,  7.6235e+00,  4.5868e+00,  4.3892e+00,
         9.8253e+00,  1.3546e+01,  1.4797e+01, -1.9918e+01,  2.0733e+00,
        -1.0531e+01,  6.4505e+00, -7.7934e+00,  3.1231e+00, -3.4946e+00,
        -2.3536e+00, -1.2395e+01,  9.7166e+00, -9.3898e-01,  9.6071e+00,
         1.3101e+01, -1.6433e+00, -1.4522e+01, -1.4720e+00, -1.3235e+01,
        -9.0775e+00,  1.8865e+00,  5.8545e+00, -4.6516e+00, -3.3164e+00,
         5.6911e+00, -1.3589e+00,  8.3999e+00, -2.6906e+01,  3.5116e+01,
         1.2461e+01,  2.2515e-01, -3.8847e+00, -1.9279e+01, -1.2961e+01,
         9.2327e+00, -1.2788e+01, -2.6388e+01, -1.0314e+01,  1.7547e+00,
        -7.0666e+00,  3.9086e+00, -1.1245e+01,  2.2797e+01,  5.4892e+00,
        -1.2174e+00, -1.5317e+01, -1.3012e+01, -1.2343e+01, -4.9563e+00,
         5.1569e+00,  8.9322e-01, -1.9571e+01, -3.7586e+00,  9.8887e+00,
         8.2983e-01,  6.4590e+00, -5.1590e+00, -7.7171e+00,  3.0514e+00,
        -1.0311e+01, -4.6693e+00, -3.4670e+00, -2.2920e+01,  8.0115e+00,
         9.9806e+00, -6.2349e+00,  7.1516e+00, -4.6689e+00, -1.0598e+01,
         3.0340e+00, -2.1134e+00, -3.7825e+00,  1.7961e+01,  8.7266e+00,
         2.5308e+01, -2.0716e+01,  3.7606e+01,  2.8623e+01, -2.3240e+00,
        -1.6690e+01,  2.3153e+01, -2.2798e+01, -1.6386e+01,  6.4888e+00,
        -1.5488e+01,  1.3761e+01,  3.8349e+00, -1.6937e+01, -9.4635e+00,
        -9.0758e+00, -7.4725e+00, -1.4626e+01,  6.8836e+00, -1.1713e+01,
        -1.2530e+01,  8.2324e+00,  1.4580e+01,  1.3494e+01, -1.9453e+01,
         1.6461e+01, -2.2620e+01, -1.7914e+01,  2.2092e+01,  7.3166e-01,
        -1.4763e+00, -1.6318e+01, -1.9783e+01,  3.9969e+01, -1.2729e+01,
        -8.8779e+00,  2.0092e+01, -8.4574e+00,  1.6190e+01, -1.9558e+01,
        -1.4551e+01, -2.3117e+01,  8.0841e-01,  1.0100e+01,  1.8020e+01,
         3.9883e+00, -3.3194e+00,  1.8115e+01, -1.1316e+01,  2.4472e+01,
        -3.7555e-01, -1.3127e+01,  1.1065e+01,  3.2246e+00,  3.8472e+00,
        -1.5031e+01, -1.7646e+01,  9.9691e+00, -2.1253e-01,  8.9707e+00,
        -2.2589e+01,  1.2053e+01, -1.3736e+01,  1.3855e+00, -1.3806e+01,
        -6.8595e+00, -6.4280e-01,  8.4295e+00,  9.7112e+00, -2.7169e+01,
         9.1873e+00, -2.4057e+01, -1.1748e+00,  1.9332e+00,  3.5764e+01,
         2.8834e+01, -4.1234e-01,  1.5578e+01,  1.1371e+01,  1.5097e+01,
         1.6715e+01,  1.1700e-01, -1.5063e+01, -4.5732e+00, -8.8555e+00,
         3.4605e+01,  1.3004e+00, -7.4721e+00,  6.6520e+00, -1.0266e+01,
         6.0415e+00,  2.1736e+01,  1.3761e+00,  3.7125e+00, -1.2651e+01,
        -5.4525e+00,  1.9180e+00, -4.7557e+00,  8.6083e+00,  4.3072e-01,
         1.2014e+01,  5.9331e+00, -7.7552e+00,  1.2085e+01,  1.1096e-01,
         1.5337e+01, -8.1269e+00,  3.5360e+01, -5.0948e+00, -1.1001e+01,
         2.0167e+00, -1.9558e+01,  1.7240e+01,  1.9882e+00,  1.6020e+01,
        -3.5983e+00,  2.5248e+01,  1.0253e+01, -6.9858e+00,  2.3751e+01,
         5.0431e+00, -1.2847e+01,  1.3495e+01, -2.1456e+01,  1.2319e+01,
         2.0771e+01, -1.3560e+01, -1.0879e+01, -2.4244e+01, -1.1281e+01,
        -2.2507e+00,  4.9116e+00,  2.2562e+01, -3.7998e+01, -6.7854e+00,
        -1.0124e+01,  3.4786e+00, -1.3182e+00, -1.8311e+01, -8.6845e-01,
         6.4291e+00,  1.8812e+00,  8.0737e+00,  1.6346e+01, -4.9505e+00,
         1.4463e+01, -1.6847e+01,  1.8748e+00,  1.7298e+00,  1.3091e+01,
         1.5773e+01, -8.7424e+00,  3.1879e+00, -5.9136e+00, -2.4497e+01,
        -7.4338e+00,  7.1627e+00,  9.1836e+00,  5.9182e+00, -4.3293e+00,
        -1.7193e+01,  4.1447e+00,  2.0233e+00,  2.0987e+01, -1.1283e+01,
        -8.2337e+00, -3.1205e-01, -1.0439e+01,  2.9605e+01,  1.4553e+00,
        -5.4369e+00,  8.7905e+00, -2.8944e-02, -6.3778e+00,  4.4226e-01,
         2.5580e+00,  3.7077e+00, -1.0712e+01,  1.2256e+01,  8.5198e+00,
         3.3696e+01, -6.6565e-01,  3.9630e+00,  4.6934e+00, -3.0869e+00,
         1.7169e+01,  1.0379e+01,  5.6603e+00,  3.5504e+00,  1.7314e+01,
        -1.7155e+01, -1.9899e+01, -8.6625e+00, -4.2419e+00, -1.9605e+01,
         1.7679e+01, -8.4512e+00, -5.4343e+00, -9.6133e+00,  1.2983e+01,
        -9.6667e+00, -7.8237e+00,  3.6070e+01, -9.8899e+00,  1.3567e+00,
         1.7311e+01, -7.0531e+00,  2.1473e+01, -4.3401e+00,  3.9490e+00,
        -3.0868e+00,  2.1150e+01, -4.4665e-01,  8.6786e+00, -2.9844e+01,
        -1.7760e+01, -3.1497e+00, -7.9443e+00, -1.1582e+01, -1.1137e+01,
        -1.2639e+01, -2.3941e+00,  9.0517e-01, -3.1459e+01, -1.4315e-01,
         8.2485e+00,  1.8679e+01, -2.4565e+01, -8.8031e+00, -1.2671e+00,
         9.9179e+00,  3.2515e+00, -1.7620e+00,  8.1521e+00, -1.1968e+01,
        -1.8648e-01,  4.5210e+00,  8.4186e+00, -1.2096e+01, -1.6994e+01,
        -3.3044e+01, -1.5995e+01,  1.8448e+01, -8.1769e+00, -1.6882e+01,
        -1.7981e+01,  1.4874e+01, -1.6058e+00,  5.8986e+00, -1.6934e+00,
         3.1761e+00, -1.7812e+01,  4.0299e+00,  5.6600e+00, -7.1904e+00,
        -1.9878e+00,  1.3446e+01,  4.5043e+00,  3.8669e+00,  6.2275e+00,
         4.0025e+00, -1.8053e+00,  1.3680e+01, -1.4912e+01,  1.4223e+01,
         1.3686e+01,  7.1422e+00, -1.1007e+01, -7.7955e-01,  6.3852e+00,
        -4.7018e+00,  1.4314e+01,  1.1151e+01, -1.0890e+01,  1.0695e+01,
         7.8126e+00,  6.4556e+00,  1.8060e+01,  1.6648e+01, -2.9283e+00,
         1.0624e+01, -1.3980e+01,  1.3768e+01,  6.8500e+00, -1.3413e+01,
         3.4042e+01,  2.6628e+01, -1.3958e+01, -6.7140e-01,  1.1670e+01,
        -2.7355e-01, -8.0873e+00, -3.2707e+00,  2.2148e+01,  2.6298e+00,
        -1.1375e+00, -2.4391e+01, -1.7606e+01,  2.8643e+01, -1.9893e+01,
        -3.5965e+00, -6.9813e+00,  8.1860e+00, -1.9679e+01,  1.7968e+01,
         5.1700e+00, -1.5956e+01, -3.2299e+00,  1.3124e+01, -7.3802e+00,
         1.5770e+01,  3.7176e+00,  1.3502e+01,  8.4801e+00, -2.4123e+00,
         2.0579e+01,  2.7809e-01], grad_fn=<SelectBackward0>)
```

## Task 05

**Description:**

Extend the class to be able to apply masking on the padding tokens using a mask.

To make it easier to use and more reusable in general, move the logic for creating a mask given an input, into a function - `create_src_mask`.

Use the following input ($0$ means padding token):

```python
token_ids = torch.tensor([[1, 2, 3, 4], [5, 6, 7, 8], [9, 9, 0, 0]])
```

Output:

- The shape of input before passing it to the function `create_src_mask`.
- The shape of the output of the function `create_src_mask`.
- The mask.
- The attention score before weighing them with the values.
- The shape of the output of the head.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. Masking is applied in the encoder.
2. The test case passes.
3. A seed is set for reproducibility.

**Test case:**

```console
python task05.py
```

```console
Input shape to "create_src_mask": torch.Size([3, 4])
Output shape of "create_src_mask": torch.Size([3, 4, 4])
Mask: tensor([[[1, 1, 1, 1],
         [1, 1, 1, 1],
         [1, 1, 1, 1],
         [1, 1, 1, 1]],

        [[1, 1, 1, 1],
         [1, 1, 1, 1],
         [1, 1, 1, 1],
         [1, 1, 1, 1]],

        [[1, 1, 0, 0],
         [1, 1, 0, 0],
         [1, 1, 0, 0],
         [1, 1, 0, 0]]])
Attention scores of the last batch: tensor([[0.7579, 0.2421, 0.0000, 0.0000],
        [0.7196, 0.2804, 0.0000, 0.0000],
        [0.1816, 0.8184, 0.0000, 0.0000],
        [0.1752, 0.8248, 0.0000, 0.0000]], grad_fn=<SelectBackward0>)
Shape of output of head: torch.Size([3, 4, 512])
```

## Task 06

**Description:**

Create a class `MultiHeadAttention` to represent multiple heads of self-attention running in parallel.

Use it to apply a `4`-headed self-attention using the input for `Task 5`. Print the shape of the result and the output for the first element in the first batch.

Output the shape of the output and the output in the first element in the first batch.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. Multi-head attention is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. An appropriate value is set for the parameter `head_size`.
5. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task06.py
```

```console
Shape of output of multi-head attention: torch.Size([3, 4, 512])
Output for the first element in the first batch: tensor([ 1.6017e+01, -9.0762e+01, -1.3353e+01,  1.4055e+01, -1.0558e+01,
         2.2891e+01, -6.0870e+00,  7.3265e+00, -7.6274e+00, -1.1401e+01,
         9.9919e+00,  2.5546e+01,  1.1190e+01, -9.1676e+00,  1.1628e+01,
        -8.6133e+00,  7.6473e-01,  2.2487e+01, -1.6187e+01, -1.5651e+01,
        -1.6403e+01,  2.0942e+01, -8.7947e+00,  3.4690e+00, -7.8235e+00,
         4.3748e+00,  1.3202e+01,  1.3428e+01,  1.3483e+01,  1.1599e+01,
         4.1695e+00,  1.0569e+01, -2.4895e+01, -2.3851e+01,  1.2439e+01,
         1.8178e+00,  1.1711e+01,  2.1696e+01, -3.2923e+00,  6.3461e+00,
         3.9018e+00, -1.4333e+01,  2.0108e+01,  9.7682e-01,  7.6270e+00,
        -1.8827e+01, -1.0849e+01,  2.3906e+01,  1.2442e+01, -1.5889e+01,
         1.1622e+01,  2.1001e+00,  6.8068e-01,  4.4641e+00, -3.2620e+01,
        -2.7368e+00, -3.5377e+01,  7.3502e+00, -1.7435e+01, -8.5467e+00,
        -1.4090e+00,  1.1692e+00, -3.8689e+01,  2.2900e+00, -1.3076e+01,
         7.5516e+00, -1.0223e+01,  7.8519e+00,  7.0287e+00,  2.2716e+01,
        -9.8524e+00,  1.4175e+00,  1.2269e+01, -3.5452e+00, -5.0049e+00,
         1.2787e+01,  1.6241e+00,  7.0464e+00, -1.2009e+01,  2.8812e+01,
         1.3443e+01, -2.1367e+00,  2.0536e+01, -2.8311e+00, -1.8094e+01,
         1.7600e+01,  6.6706e+00, -7.7071e+00,  2.6086e-01,  4.6976e+00,
         1.6891e+01, -1.0164e+01,  9.7596e+00,  2.1778e-01,  5.7806e+00,
         9.1204e+00,  7.1267e+00,  8.0488e-01, -9.9310e-02, -7.8639e+00,
        -1.2560e+01,  2.9135e+00, -1.2889e+01,  3.7150e+00,  1.0698e+01,
        -6.7787e+00, -4.2087e+00,  1.9467e+01,  2.7918e+01, -1.3778e-02,
         6.4304e+00, -9.1383e+00, -2.2031e+01,  9.6836e+00, -1.7022e-01,
        -6.5175e+00, -2.0230e+01,  7.6235e+00,  4.5868e+00,  4.3892e+00,
         9.8253e+00,  1.3546e+01,  1.4797e+01, -1.9918e+01,  2.0733e+00,
        -1.0531e+01,  6.4505e+00, -7.7934e+00,  1.6017e+01, -9.0762e+01,
        -1.3353e+01,  1.4055e+01, -1.0558e+01,  2.2891e+01, -6.0870e+00,
         7.3265e+00, -7.6274e+00, -1.1401e+01,  9.9919e+00,  2.5546e+01,
         1.1190e+01, -9.1676e+00,  1.1628e+01, -8.6133e+00,  7.6473e-01,
         2.2487e+01, -1.6187e+01, -1.5651e+01, -1.6403e+01,  2.0942e+01,
        -8.7947e+00,  3.4690e+00, -7.8235e+00,  4.3748e+00,  1.3202e+01,
         1.3428e+01,  1.3483e+01,  1.1599e+01,  4.1695e+00,  1.0569e+01,
        -2.4895e+01, -2.3851e+01,  1.2439e+01,  1.8178e+00,  1.1711e+01,
         2.1696e+01, -3.2923e+00,  6.3461e+00,  3.9018e+00, -1.4333e+01,
         2.0108e+01,  9.7682e-01,  7.6270e+00, -1.8827e+01, -1.0849e+01,
         2.3906e+01,  1.2442e+01, -1.5889e+01,  1.1622e+01,  2.1001e+00,
         6.8068e-01,  4.4641e+00, -3.2620e+01, -2.7368e+00, -3.5377e+01,
         7.3502e+00, -1.7435e+01, -8.5467e+00, -1.4090e+00,  1.1692e+00,
        -3.8689e+01,  2.2900e+00, -1.3076e+01,  7.5516e+00, -1.0223e+01,
         7.8519e+00,  7.0287e+00,  2.2716e+01, -9.8524e+00,  1.4175e+00,
         1.2269e+01, -3.5452e+00, -5.0049e+00,  1.2787e+01,  1.6241e+00,
         7.0464e+00, -1.2009e+01,  2.8812e+01,  1.3443e+01, -2.1367e+00,
         2.0536e+01, -2.8311e+00, -1.8094e+01,  1.7600e+01,  6.6706e+00,
        -7.7071e+00,  2.6086e-01,  4.6976e+00,  1.6891e+01, -1.0164e+01,
         9.7596e+00,  2.1778e-01,  5.7806e+00,  9.1204e+00,  7.1267e+00,
         8.0488e-01, -9.9310e-02, -7.8639e+00, -1.2560e+01,  2.9135e+00,
        -1.2889e+01,  3.7150e+00,  1.0698e+01, -6.7787e+00, -4.2087e+00,
         1.9467e+01,  2.7918e+01, -1.3778e-02,  6.4304e+00, -9.1383e+00,
        -2.2031e+01,  9.6836e+00, -1.7022e-01, -6.5175e+00, -2.0230e+01,
         7.6235e+00,  4.5868e+00,  4.3892e+00,  9.8253e+00,  1.3546e+01,
         1.4797e+01, -1.9918e+01,  2.0733e+00, -1.0531e+01,  6.4505e+00,
        -7.7934e+00,  1.6017e+01, -9.0762e+01, -1.3353e+01,  1.4055e+01,
        -1.0558e+01,  2.2891e+01, -6.0870e+00,  7.3265e+00, -7.6274e+00,
        -1.1401e+01,  9.9919e+00,  2.5546e+01,  1.1190e+01, -9.1676e+00,
         1.1628e+01, -8.6133e+00,  7.6473e-01,  2.2487e+01, -1.6187e+01,
        -1.5651e+01, -1.6403e+01,  2.0942e+01, -8.7947e+00,  3.4690e+00,
        -7.8235e+00,  4.3748e+00,  1.3202e+01,  1.3428e+01,  1.3483e+01,
         1.1599e+01,  4.1695e+00,  1.0569e+01, -2.4895e+01, -2.3851e+01,
         1.2439e+01,  1.8178e+00,  1.1711e+01,  2.1696e+01, -3.2923e+00,
         6.3461e+00,  3.9018e+00, -1.4333e+01,  2.0108e+01,  9.7682e-01,
         7.6270e+00, -1.8827e+01, -1.0849e+01,  2.3906e+01,  1.2442e+01,
        -1.5889e+01,  1.1622e+01,  2.1001e+00,  6.8068e-01,  4.4641e+00,
        -3.2620e+01, -2.7368e+00, -3.5377e+01,  7.3502e+00, -1.7435e+01,
        -8.5467e+00, -1.4090e+00,  1.1692e+00, -3.8689e+01,  2.2900e+00,
        -1.3076e+01,  7.5516e+00, -1.0223e+01,  7.8519e+00,  7.0287e+00,
         2.2716e+01, -9.8524e+00,  1.4175e+00,  1.2269e+01, -3.5452e+00,
        -5.0049e+00,  1.2787e+01,  1.6241e+00,  7.0464e+00, -1.2009e+01,
         2.8812e+01,  1.3443e+01, -2.1367e+00,  2.0536e+01, -2.8311e+00,
        -1.8094e+01,  1.7600e+01,  6.6706e+00, -7.7071e+00,  2.6086e-01,
         4.6976e+00,  1.6891e+01, -1.0164e+01,  9.7596e+00,  2.1778e-01,
         5.7806e+00,  9.1204e+00,  7.1267e+00,  8.0488e-01, -9.9310e-02,
        -7.8639e+00, -1.2560e+01,  2.9135e+00, -1.2889e+01,  3.7150e+00,
         1.0698e+01, -6.7787e+00, -4.2087e+00,  1.9467e+01,  2.7918e+01,
        -1.3778e-02,  6.4304e+00, -9.1383e+00, -2.2031e+01,  9.6836e+00,
        -1.7022e-01, -6.5175e+00, -2.0230e+01,  7.6235e+00,  4.5868e+00,
         4.3892e+00,  9.8253e+00,  1.3546e+01,  1.4797e+01, -1.9918e+01,
         2.0733e+00, -1.0531e+01,  6.4505e+00, -7.7934e+00,  1.6017e+01,
        -9.0762e+01, -1.3353e+01,  1.4055e+01, -1.0558e+01,  2.2891e+01,
        -6.0870e+00,  7.3265e+00, -7.6274e+00, -1.1401e+01,  9.9919e+00,
         2.5546e+01,  1.1190e+01, -9.1676e+00,  1.1628e+01, -8.6133e+00,
         7.6473e-01,  2.2487e+01, -1.6187e+01, -1.5651e+01, -1.6403e+01,
         2.0942e+01, -8.7947e+00,  3.4690e+00, -7.8235e+00,  4.3748e+00,
         1.3202e+01,  1.3428e+01,  1.3483e+01,  1.1599e+01,  4.1695e+00,
         1.0569e+01, -2.4895e+01, -2.3851e+01,  1.2439e+01,  1.8178e+00,
         1.1711e+01,  2.1696e+01, -3.2923e+00,  6.3461e+00,  3.9018e+00,
        -1.4333e+01,  2.0108e+01,  9.7682e-01,  7.6270e+00, -1.8827e+01,
        -1.0849e+01,  2.3906e+01,  1.2442e+01, -1.5889e+01,  1.1622e+01,
         2.1001e+00,  6.8068e-01,  4.4641e+00, -3.2620e+01, -2.7368e+00,
        -3.5377e+01,  7.3502e+00, -1.7435e+01, -8.5467e+00, -1.4090e+00,
         1.1692e+00, -3.8689e+01,  2.2900e+00, -1.3076e+01,  7.5516e+00,
        -1.0223e+01,  7.8519e+00,  7.0287e+00,  2.2716e+01, -9.8524e+00,
         1.4175e+00,  1.2269e+01, -3.5452e+00, -5.0049e+00,  1.2787e+01,
         1.6241e+00,  7.0464e+00, -1.2009e+01,  2.8812e+01,  1.3443e+01,
        -2.1367e+00,  2.0536e+01, -2.8311e+00, -1.8094e+01,  1.7600e+01,
         6.6706e+00, -7.7071e+00,  2.6086e-01,  4.6976e+00,  1.6891e+01,
        -1.0164e+01,  9.7596e+00,  2.1778e-01,  5.7806e+00,  9.1204e+00,
         7.1267e+00,  8.0488e-01, -9.9310e-02, -7.8639e+00, -1.2560e+01,
         2.9135e+00, -1.2889e+01,  3.7150e+00,  1.0698e+01, -6.7787e+00,
        -4.2087e+00,  1.9467e+01,  2.7918e+01, -1.3778e-02,  6.4304e+00,
        -9.1383e+00, -2.2031e+01,  9.6836e+00, -1.7022e-01, -6.5175e+00,
        -2.0230e+01,  7.6235e+00,  4.5868e+00,  4.3892e+00,  9.8253e+00,
         1.3546e+01,  1.4797e+01, -1.9918e+01,  2.0733e+00, -1.0531e+01,
         6.4505e+00, -7.7934e+00], grad_fn=<SelectBackward0>)
```

## Task 07

**Description:**

Define a class `FeedForwardSubLayer` that represents the feed-forward part of the Transformer architecture.

Apply it on the output of `Task 6`, using a hidden dimension of `2048`.

Output the shape of the input to the layer and the shape of the output of the layer.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. The layer is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task07.py
```

```console
Input shape: torch.Size([3, 4, 512])
Output shape: torch.Size([3, 4, 512])
```

## Task 08

**Description:**

Define a class `EncoderLayer` that represents a single encoder layer. Use a dropout rate of $0.1$.

Output:

- the shape of the input to the layer;
- the shape of the output of the layer;
- the first element in the first batch.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. The layer is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task08.py
```

```console
Input shape: torch.Size([3, 4, 512])
Output shape: torch.Size([3, 4, 512])
First element in first batch: tensor([ 3.9713e-02, -3.8173e+00, -1.7068e-01,  1.4795e-01, -9.9840e-02,
         2.1003e+00, -1.2408e+00,  2.2341e-01, -5.9493e-01, -5.3410e-01,
         1.6361e+00,  1.5113e+00,  1.1707e+00, -8.9054e-01,  6.0593e-01,
        -2.9938e-01,  1.4220e+00,  4.9901e-01, -2.2395e+00, -1.8599e+00,
         2.3778e+00,  4.7497e-01, -6.6806e-01,  4.2761e-01, -3.7129e-01,
        -1.0560e+00,  1.2073e+00, -1.0362e-01,  8.3012e-01, -1.6147e-01,
        -6.7584e-01,  4.8149e-02, -3.0103e-01, -1.5814e+00,  1.5884e+00,
         5.2652e-01,  4.1455e-02,  6.1843e-01, -3.7875e-01, -1.0342e+00,
         2.8639e-02, -1.2582e+00,  1.0133e+00, -4.4165e-02, -5.8358e-01,
        -1.6944e+00, -1.3457e+00,  5.8641e-01,  4.0380e-01, -4.4248e-01,
         3.4708e-01,  6.0609e-01, -6.7903e-01,  4.8469e-01, -7.6465e-02,
        -2.2543e+00, -1.7953e+00, -1.3427e+00, -6.6077e-01, -4.5355e-01,
        -4.7415e-01,  4.3911e-01,  6.2189e-02, -2.2384e+00,  3.7613e-01,
         2.4626e-01,  3.0193e-01,  5.2013e-01,  5.6346e-01, -5.3625e-01,
        -9.9043e-01, -2.6202e-01,  1.5113e+00, -7.7138e-01, -4.0348e-01,
        -1.1177e-01,  4.2112e-01,  3.0832e-01, -1.2063e+00,  1.1259e+00,
         1.3417e-01,  8.1836e-01,  2.6625e-02, -9.2052e-01,  9.1371e-01,
         1.9864e+00, -2.3408e-01,  2.4063e-01,  2.3002e-01,  1.1170e+00,
         1.3921e-01, -4.1736e-01,  4.6985e-01,  3.4403e-01, -1.0188e+00,
        -1.6140e+00, -1.0454e+00,  4.6110e-01, -4.1967e-01,  3.7951e-02,
        -1.2178e+00,  1.5452e+00, -3.9551e-01,  5.8153e-01,  9.4798e-01,
        -1.2536e+00, -6.5648e-01, -5.5665e-02,  1.1091e+00,  4.1106e-01,
         4.2040e-01, -2.8110e-01, -1.7143e+00,  1.4679e-01, -1.5292e-01,
        -1.4755e+00, -1.9254e+00,  8.3861e-01,  9.0160e-01, -1.7389e+00,
         7.3589e-01,  1.9523e+00,  4.4078e-01, -1.3279e+00,  1.5172e+00,
        -1.3915e+00,  1.3523e+00, -5.2766e-01, -5.1267e-01, -2.4721e+00,
         2.5643e-02,  5.5466e-02, -1.2283e+00,  1.6889e-02, -2.0636e+00,
         3.2279e-01,  1.3031e+00, -1.1118e+00,  4.4738e-01,  1.5867e+00,
         1.0676e+00,  3.1155e-01,  4.3193e-01, -4.3978e-01, -1.2498e+00,
         1.4372e-01,  8.8954e-01, -7.6923e-01,  2.5264e-01,  1.1577e+00,
        -1.1345e+00, -2.2978e-01, -8.7261e-01,  4.3655e-01, -3.9274e-01,
         3.2764e-01,  5.0816e-02, -8.1644e-01,  1.5379e-01,  1.5270e+00,
         2.6012e-01, -1.1464e+00,  1.7582e-01,  1.4493e+00,  7.5890e-02,
         1.5130e+00, -1.0043e-01, -1.0198e+00,  5.4779e-01,  6.4296e-01,
         1.2658e+00, -8.8306e-01,  1.1527e+00,  1.1729e+00, -3.1501e-02,
         1.2972e+00,  6.4205e-01, -1.6294e+00, -1.0462e+00,  6.1776e-01,
        -5.8561e-01,  1.0174e+00, -2.4362e+00, -7.7609e-01, -1.6145e+00,
         9.9866e-02,  7.6268e-02, -4.7703e-01, -2.1170e-01,  1.3201e-01,
        -2.5355e+00, -4.8133e-01, -8.4302e-01, -1.2909e+00, -1.3409e+00,
         1.5163e-01, -4.7133e-01, -1.2967e-01, -7.8716e-01, -7.6085e-01,
         8.1272e-01, -1.1255e+00, -1.1383e+00, -4.8679e-02,  2.0353e-01,
         2.0876e-01, -1.2461e-01,  6.5562e-01,  8.8157e-01,  1.2437e+00,
         2.3328e+00, -4.5055e-01, -1.2003e+00,  1.1001e+00,  2.8161e-02,
         3.1814e-03,  7.8849e-01,  1.5074e+00, -8.1502e-01, -6.3733e-01,
         1.3709e+00, -3.9820e-01, -9.6214e-03,  1.1232e+00,  3.1344e-01,
        -9.4387e-02,  5.7148e-01, -1.8766e+00,  5.2920e-01,  4.2893e-01,
        -1.2401e+00,  2.1435e-01,  4.1293e-01, -2.7290e-01,  6.4390e-01,
         1.1631e+00,  1.8597e+00, -9.2534e-02,  1.0282e+00, -6.4475e-01,
        -9.6237e-01,  1.0872e+00,  4.1437e-02, -6.6349e-02, -2.0441e+00,
         1.2383e+00,  1.0468e+00, -1.4201e+00,  2.6107e-01, -8.0851e-01,
         5.7832e-01, -2.2798e-01,  8.4093e-01, -9.2954e-01, -7.6799e-01,
         7.6291e-02,  9.8064e-01, -2.7802e+00, -2.7964e-01,  1.2069e+00,
        -9.6392e-01,  1.3892e+00, -5.2911e-01,  1.0819e+00, -4.4420e-01,
        -1.1611e+00,  3.7181e-01,  6.1092e-01,  1.1025e+00, -8.8309e-01,
        -3.1121e-01, -5.8923e-01,  1.0260e+00,  1.3495e+00,  1.7076e-01,
        -2.2589e-01,  5.1339e-01,  8.4711e-01, -1.0105e+00,  1.4927e-01,
        -4.9951e-01, -2.2580e-02, -6.9593e-01,  4.6005e-01, -5.0939e-02,
        -1.4768e-02,  8.4095e-03,  1.0004e+00,  1.1034e-01, -1.1108e+00,
         8.8456e-01,  2.7772e-01,  1.8682e+00,  1.8870e+00,  2.8583e-01,
        -1.7930e-01, -7.4802e-01, -5.3861e-01,  1.3841e+00,  4.5261e-01,
         2.6293e-01, -1.0559e+00, -2.9940e-01,  1.3867e+00, -7.1332e-01,
        -1.3204e+00,  1.1254e+00,  8.7300e-01, -7.5475e-01, -6.8796e-02,
        -1.9595e+00,  2.0825e-01, -9.2875e-01,  4.2151e-01, -4.6590e-01,
         6.0875e-01, -1.4258e-02, -1.8778e-01, -1.8364e+00,  6.6765e-01,
        -1.8996e+00,  5.5863e-02,  4.7654e-02,  5.4240e-01, -2.6567e-01,
         1.5263e+00, -5.2934e-01,  4.5748e-01,  1.0149e+00, -8.7355e-01,
        -1.9993e-01, -1.3616e+00,  6.5219e-01,  1.1575e+00, -4.3837e-01,
         1.5874e+00,  1.9282e+00,  8.3731e-02,  1.6263e+00, -1.6457e-01,
        -1.6289e-01,  7.1646e-01,  8.3420e-01, -1.5103e-02, -4.6777e-01,
        -3.5625e-01, -1.0737e+00, -5.1728e-01, -1.0042e-01, -1.7176e+00,
         7.7994e-01, -1.4520e+00,  6.2862e-01, -1.0324e+00, -3.6889e-01,
         1.1196e+00, -5.4743e-02,  4.8101e-01,  3.2937e-01,  8.8768e-01,
         1.3300e+00, -8.5587e-02,  6.8091e-01,  9.7711e-01,  1.2079e+00,
         2.7448e-01,  5.3625e-01,  1.0585e+00, -1.1940e+00, -5.9198e-01,
         5.1586e-01,  3.4460e-01, -8.7476e-01,  1.2371e-01,  9.5370e-01,
         1.0710e-01,  6.2635e-01, -1.0604e+00,  5.3734e-01, -1.2892e+00,
         7.6893e-01, -1.2995e+00, -9.5630e-01, -7.1929e-01,  6.3709e-01,
        -2.4864e+00, -2.2481e+00,  9.6236e-01, -2.3158e+00,  8.7145e-01,
        -4.8869e-01,  1.6927e+00, -6.2818e-01,  2.8404e-01,  1.7450e+00,
         1.5351e+00,  9.9637e-01, -1.0535e+00, -7.1925e-01, -1.7469e-01,
         3.2717e-02,  8.2633e-01, -2.6094e-01,  3.0275e-01,  2.4075e-01,
         7.4628e-01,  8.9884e-03, -2.1674e-01, -6.5634e-01,  4.3065e-01,
         8.3340e-01,  9.7827e-02,  7.0059e-01,  2.8945e+00, -8.4368e-01,
         5.6424e-01, -2.6640e+00, -1.4087e+00,  7.3564e-01,  6.4124e-02,
         8.2987e-01,  4.9379e-01, -1.0538e+00, -1.8597e-01,  1.3555e+00,
        -6.6676e-01, -1.0175e+00, -1.3114e-01,  3.0166e-01, -8.3753e-01,
        -6.7446e-02,  1.1590e+00, -9.4100e-02, -3.4696e-02,  5.0702e-01,
         1.7803e+00, -8.1437e-01,  1.3127e-01, -6.6679e-01, -2.3725e-01,
        -6.4030e-01,  1.7530e+00, -1.0818e+00, -2.2459e-01, -8.9609e-01,
        -5.0881e-01,  1.2262e-01, -4.8218e-01, -1.0572e+00, -8.0977e-01,
        -5.7000e-01,  2.6352e+00, -8.0578e-01,  1.5981e+00, -1.5688e+00,
        -8.6022e-02,  3.2460e+00, -5.5268e-01,  4.9256e-02,  2.7724e+00,
        -2.1649e-01,  3.4308e-01, -9.2576e-01, -3.1651e-01,  1.6926e+00,
        -4.8317e-01,  1.5923e+00,  9.4003e-02,  7.0034e-01,  2.9944e+00,
         2.3500e+00, -8.5268e-01,  3.3497e-01, -2.0700e-01,  3.7425e-01,
        -3.6130e-01,  5.5196e-01, -5.3666e-02,  3.8541e-01, -1.5916e-01,
        -1.5446e+00, -5.0382e-01, -6.2209e-01,  3.0806e-01,  2.4425e-01,
        -6.4328e-01, -1.0833e+00, -4.1085e-01,  3.9220e-01,  3.3112e-01,
         3.2715e-02,  1.3439e+00,  1.2083e+00,  3.2230e-01, -5.8594e-01,
        -9.4196e-01, -1.7939e-01,  8.8538e-01, -2.6013e-01,  1.1075e-01,
        -6.8100e-01,  1.0810e+00, -4.8652e-01,  7.0936e-03, -1.1101e+00,
         9.8358e-01, -1.0683e-01, -1.2893e+00, -4.4052e-01, -9.8155e-01,
        -2.4866e-01, -6.3798e-01], grad_fn=<SelectBackward0>)
```

## Task 09

**Description:**

Define a class `TransformerEncoder` that represents an encoder block of several encoder layers.

Set the:

- vocabulary size to $10,000$;
- embedding dimension to $512$;
- number of encoder layers to $4$;
- number of attention heads to $4$;
- hidden dimension of the feed-forward layer to $2,048$;
- dropout rate to $0.1$;
- maximum sequence length to $4$.

Output:

- the shape of the input to the block;
- the shape of the output of the block;
- the first element in the first batch.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. The block is implemented as shown in the Transformer paper and in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task09.py
```

```console
Input shape: torch.Size([3, 4])
Output shape: torch.Size([3, 4, 512])
First element in first batch: tensor([ 1.0929e+00, -3.4793e+00, -4.7646e-01,  4.8183e-01,  2.9931e-01,
         7.4576e-01, -9.5533e-01, -2.6323e-01, -4.3483e-01, -8.6719e-01,
         2.1191e+00,  7.6769e-01,  7.3145e-01,  5.0003e-01,  8.3469e-01,
        -1.1745e+00,  1.7696e+00,  1.3119e+00, -2.0686e+00, -8.9648e-01,
        -1.5852e-01,  4.0921e-01, -6.2470e-01,  8.7091e-01,  3.0146e-01,
        -7.9897e-01,  6.6145e-01,  2.2791e-01,  1.4290e-01,  1.5783e+00,
        -4.8518e-01,  1.7586e-01, -6.2861e-01, -6.8916e-01,  1.8023e+00,
         4.1121e-01, -7.2009e-01,  1.9456e+00, -7.6418e-01,  2.9089e-01,
         3.4447e-01, -3.2771e-01, -2.2330e-01, -9.0232e-02, -7.0927e-02,
        -1.3382e+00, -7.2398e-01,  1.3145e+00,  6.1582e-01, -1.7749e+00,
        -1.6753e-02, -2.7632e-01, -6.1666e-01,  7.6480e-01, -1.9540e-01,
        -1.5321e+00, -1.6565e+00, -4.9268e-01, -6.3282e-01, -4.5356e-01,
         2.4687e-03,  7.1912e-01, -7.2542e-01, -2.3514e+00, -1.8516e+00,
        -3.5778e-01, -1.2558e-01,  3.6507e-01,  4.9267e-02,  1.3676e+00,
        -3.9695e-01, -8.9936e-01,  6.5253e-01,  1.2346e+00,  2.6909e-01,
        -1.6407e-01,  8.5128e-01,  6.1018e-01, -7.5037e-01,  1.6946e+00,
        -3.6275e-01,  6.3276e-01,  2.2825e-01, -6.1716e-01, -7.0773e-01,
         1.1824e+00,  1.2449e-01,  7.6830e-01, -1.3044e+00,  1.1571e+00,
         1.0528e+00,  2.9452e-01,  1.5585e+00,  9.5356e-01,  6.0289e-01,
        -4.0828e-01, -5.8151e-01,  1.0666e+00, -1.9799e-01, -6.5048e-01,
        -8.5451e-01,  3.1344e-01, -6.4089e-01, -2.0271e-01, -1.5838e-01,
        -1.4730e+00, -3.8225e-01,  1.4363e+00,  1.5501e+00,  1.7419e-01,
        -2.4539e-01, -2.9650e-01, -1.6656e+00, -7.9824e-02,  3.8861e-01,
        -7.3326e-01, -7.7629e-01,  3.3599e-01,  9.6672e-01, -1.6655e+00,
         7.7317e-01,  6.9960e-01,  1.8444e+00, -9.4591e-01,  4.0758e-01,
        -6.9658e-01,  1.1107e+00, -1.6297e+00, -2.7783e-01, -2.7157e+00,
         2.0775e-01,  7.9506e-01, -1.1337e+00,  6.9318e-01, -1.0968e+00,
         2.4261e-01, -1.2959e-01, -4.1375e-01,  1.9058e-01,  3.9064e-01,
         4.0984e-01,  3.4584e-01, -8.5238e-01,  1.0233e-01,  2.8288e-02,
         3.6451e-01, -1.8541e-01,  3.0241e-01, -1.3468e-01,  8.5381e-01,
        -5.6371e-01,  1.7452e+00, -7.7277e-01, -5.5528e-01, -7.7157e-01,
        -9.8305e-01, -9.3013e-01, -7.0218e-01, -2.2266e-01,  1.3020e+00,
        -3.7911e-01, -6.5412e-02,  1.3319e+00,  1.2418e+00,  4.4835e-02,
         1.5169e+00, -6.0812e-01,  3.1752e-01,  1.1192e+00,  1.3553e+00,
         7.3352e-01, -1.4394e-01,  3.4973e-01, -3.8204e-01, -1.8364e-01,
         1.8386e+00, -1.5513e-01, -1.0407e+00, -2.1613e-01,  4.3213e-01,
        -1.3688e+00,  1.1075e+00, -1.1683e+00, -3.8613e-01, -1.9751e+00,
        -7.4276e-01,  1.5661e-01, -3.0532e-01,  2.7414e-01, -7.6517e-02,
        -2.2662e+00, -2.4707e+00, -2.3763e+00, -2.2234e+00, -1.3327e+00,
         5.6939e-01, -1.1773e+00,  1.5082e+00, -7.4885e-01, -8.2965e-01,
         1.1784e-01,  3.1979e-01, -2.2286e-01,  2.4650e-01,  9.5590e-01,
         6.8272e-01, -6.8932e-01,  6.3308e-01,  5.1257e-01,  1.4504e+00,
         1.2815e+00,  1.2651e-01, -2.1205e+00, -4.1927e-01,  8.1146e-01,
         1.0781e+00, -6.5492e-01,  3.1463e-01, -3.0511e-01,  5.3752e-01,
         1.6207e+00, -3.7546e-01,  1.2111e+00,  6.6655e-01,  7.9985e-01,
         4.0410e-01,  2.5147e-01, -2.4441e+00,  1.0164e+00,  1.3536e-01,
        -6.9041e-01,  6.6386e-02, -4.5887e-01, -1.0662e+00, -3.7951e-02,
         2.3265e+00,  1.6950e+00, -4.9635e-02,  1.0027e+00, -1.8052e-01,
        -6.2637e-01,  8.8835e-01,  7.9691e-01, -2.4920e-01, -1.8434e+00,
         1.5867e+00,  7.4599e-01, -7.9837e-01,  6.5822e-01, -1.4735e-02,
         1.5340e+00, -7.1426e-01,  9.1350e-01, -1.4341e+00,  3.5193e-01,
        -1.4178e+00,  1.1393e+00, -3.2200e+00,  1.7168e-01,  3.6478e-01,
        -6.0640e-01,  7.8757e-01, -2.3480e-01,  1.1803e-01, -1.8873e-01,
        -1.1092e+00,  8.6778e-01,  3.8518e-01,  7.7310e-01, -3.8694e-01,
        -7.3698e-01, -7.8979e-01,  1.1489e+00,  1.7718e+00, -1.3253e+00,
         1.1999e-01, -3.5315e-01,  6.4941e-01,  1.2108e-01,  6.5804e-01,
        -3.2771e-01, -1.8939e-01, -4.2023e-01, -1.2101e-01, -1.1297e+00,
         1.4841e+00, -8.6993e-01,  1.4052e+00, -1.8737e-01, -8.9946e-01,
         1.2124e+00,  9.3566e-02,  1.4207e+00,  2.6664e+00, -9.2270e-01,
         1.0009e+00,  7.5961e-02, -7.4766e-01,  1.4630e-01,  1.5555e-01,
        -5.7584e-01, -5.5723e-01,  3.5894e-01,  1.4994e+00,  3.0657e-01,
        -2.1133e+00,  9.4587e-01, -8.6935e-01, -3.8866e-01,  9.4819e-01,
        -2.1455e+00, -4.0357e-01, -1.0062e+00,  1.9555e-01, -2.5838e-01,
         1.0335e+00,  9.4382e-02,  1.6358e+00, -1.4673e+00, -6.1240e-01,
        -2.8957e+00, -2.1749e+00, -4.8646e-01,  1.2769e-01, -1.6269e+00,
         1.0181e+00, -2.4876e-01, -2.5591e-01, -4.7521e-02, -3.7081e-01,
         7.7638e-01, -2.8981e-01,  1.7502e-01,  8.0697e-01, -7.4123e-01,
         2.1186e+00,  2.0392e+00, -8.4175e-02,  1.0553e+00, -1.0945e+00,
        -1.1213e+00,  4.3317e-01,  1.1074e+00,  3.6284e-01, -1.2143e+00,
         2.9143e-01, -5.8453e-01, -5.4883e-01,  1.5948e+00, -7.5413e-01,
         2.0048e-01, -7.1362e-01,  1.3974e-01,  5.3147e-01, -4.3514e-01,
        -6.9337e-01,  5.8609e-01, -5.8902e-01,  6.0906e-01,  1.2110e-01,
        -3.1184e-01, -1.3351e+00, -1.1220e-01,  2.1091e+00,  2.0294e+00,
         3.5057e-01,  5.6664e-01,  7.2777e-01, -4.3292e-01,  2.5842e-01,
         8.5466e-01,  9.3299e-01, -9.0585e-01,  8.6793e-01,  5.7443e-01,
         5.9261e-01,  1.0815e+00,  3.7371e-01,  3.1071e-01, -1.1837e+00,
         5.8131e-01, -5.7995e-01, -6.0521e-01, -1.4336e+00,  8.6712e-01,
        -1.7608e+00, -1.2410e+00,  9.8554e-01, -7.9508e-01,  9.2299e-01,
        -1.3218e-01, -2.8630e-01, -9.8662e-01, -1.4632e-01,  2.0362e+00,
         1.1682e+00,  6.4171e-01,  4.8159e-02, -7.3468e-01, -4.3311e-01,
         1.6075e+00,  1.1550e+00, -1.2679e+00, -1.7450e-01, -1.4295e+00,
         3.7317e-01, -9.3060e-01,  3.0295e-01, -6.4232e-02, -5.3382e-02,
         2.5272e-01, -1.1959e+00,  2.0324e-01,  2.8536e+00, -1.4576e+00,
         2.9868e-01, -1.0773e+00, -8.6027e-01,  9.7626e-01,  2.1618e-01,
         3.0255e-01,  1.5749e+00, -9.5834e-01,  9.6646e-01,  1.5211e+00,
        -3.4136e-01, -1.9763e+00, -3.3484e-01, -7.6317e-01, -1.1436e+00,
        -1.1438e+00,  1.6129e+00, -3.0353e-01, -7.1822e-01,  6.0203e-01,
         4.4414e-01, -5.7268e-01,  3.6607e-01, -1.0652e+00, -8.4475e-01,
        -1.3871e+00, -3.0969e-02, -9.5293e-01, -6.2650e-01,  1.8703e-01,
        -4.7469e-01, -8.5644e-03, -9.3408e-01, -1.9474e+00, -1.3590e+00,
        -4.1072e-01,  1.0715e+00, -1.4824e+00,  1.8188e+00, -3.8266e-01,
        -6.2056e-01,  1.2918e+00,  9.7834e-01,  9.5581e-01,  8.2940e-01,
         3.3202e-01,  8.6267e-01, -2.4059e+00,  8.9125e-01,  1.4539e+00,
        -2.6303e-01,  6.1746e-01,  8.8979e-01,  1.9545e-02,  4.5780e-01,
         2.1244e+00, -2.6665e-01, -1.2413e+00, -1.3596e-03,  1.0505e+00,
         2.5400e-01,  1.2577e+00,  2.9819e-01, -1.5403e-02,  3.4758e-01,
        -3.1861e-01,  2.4999e-01, -1.0928e-01, -8.2910e-01,  9.8831e-02,
         6.5389e-01, -5.7162e-01, -4.8333e-01,  1.8497e-01, -1.1702e+00,
        -4.6140e-01,  1.8673e+00,  1.9615e+00,  3.4082e-02,  5.7836e-01,
        -2.5305e-01,  1.6261e-01,  2.1530e-01,  7.2917e-01,  1.2362e-01,
        -1.2850e+00,  2.0399e+00,  1.6403e-01, -4.0765e-01,  2.5206e-01,
         9.7980e-01,  9.5642e-01, -1.6361e+00, -2.7110e-01, -9.2615e-01,
        -6.1421e-01, -2.1053e+00], grad_fn=<SelectBackward0>)
```

## Task 10

**Description:**

Define a class `ClassifierHead` that represents a the classification head of an encoder-only Transformer, applying [nn.LogSoftmax](https://pytorch.org/docs/stable/generated/torch.nn.LogSoftmax.html#logsoftmax) before returning.

Set the:

- vocabulary size to $10,000$;
- embedding dimension to $512$;
- number of encoder layers to $6$;
- number of attention heads to $8$;
- hidden dimension of the feed-forward layer to $2,048$;
- dropout rate to $0.1$;
- maximum sequence length to $4$;
- number of possible output classes to $3$.

Output:

- the outputs for the batches;
- the shape of the output;
- the shape of the output of the classification head.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. The classification head is implemented as discussed in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task10.py
```

```console
Classification outputs for a batch of 3 sequences:
tensor([[[-0.9182, -1.0765, -1.3471],
         [-1.1389, -0.5600, -2.2202],
         [-1.0242, -0.6195, -2.2757],
         [-0.8540, -1.0358, -1.5172]],

        [[-0.7803, -1.3618, -1.2533],
         [-1.1387, -1.2439, -0.9377],
         [-0.8496, -1.3532, -1.1583],
         [-0.9175, -1.3003, -1.1147]],

        [[-1.2654, -0.5221, -2.0828],
         [-0.9355, -0.7101, -2.1543],
         [-1.0821, -0.6006, -2.1840],
         [-1.2565, -0.5049, -2.1910]]], grad_fn=<LogSoftmaxBackward0>)
Encoder output shape: torch.Size([3, 4, 512])
Classification head output shape: torch.Size([3, 4, 3])
```

## Task 11

**Description:**

Implement a decoder-only Transformer, including all needed layers. Apply it on the following input:

```python
input_ids = [[6044, 8239, 4933, 3760, 8963, 8379, 5427, 8503, 3497, 5683],
        [4101, 6866, 2756, 1399, 5878,  376,   56, 9868, 8794, 6033]]
```

Set the:

- vocabulary size to $10,000$;
- embedding dimension to $512$;
- number of decoder layers to $6$;
- number of attention heads to $8$;
- hidden dimension of the feed-forward layer to $2,048$;
- dropout rate to $0.1$;
- maximum sequence length to $20$.

Output:

- the result;
- the shape of the result;
- the most likely next token for each of the batches.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. A decoder-only transformer is implemented as discussed in `notes.md`.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task11.py
```

```console
tensor([[[ -9.1041,  -8.7270,  -9.5704,  ..., -10.4112,  -9.4763,  -9.3959],
         [ -9.0218,  -9.0738,  -9.2149,  ..., -10.1219,  -8.9998,  -8.8855],
         [ -8.9627,  -9.1220,  -9.4812,  ..., -10.0620,  -8.9248,  -9.9833],
         ...,
         [ -8.9640,  -8.7609, -10.0370,  ..., -10.2156, -10.1182,  -9.3435],
         [ -9.0916,  -9.5838,  -9.2363,  ..., -10.1677,  -9.3455,  -9.2363],
         [ -9.0197,  -9.8527,  -9.4743,  ..., -10.0191,  -9.3340,  -9.3685]],

        [[ -9.8380,  -9.2981,  -9.5516,  ...,  -9.5939,  -9.8512,  -9.2111],
         [ -9.8647,  -9.9782,  -9.1420,  ...,  -9.6421,  -9.5325,  -9.0065],
         [ -9.1544,  -9.0414,  -9.7704,  ...,  -9.7802,  -9.9246,  -9.8119],
         ...,
         [ -9.9106,  -9.6783,  -9.1935,  ...,  -9.5637,  -8.9973,  -9.9214],
         [ -9.0716,  -8.9261,  -9.2884,  ..., -10.4113,  -9.7325,  -9.9419],
         [ -9.5083,  -9.2930,  -9.4888,  ..., -10.1429,  -9.3472,  -9.4002]]],
       grad_fn=<LogSoftmaxBackward0>)
torch.Size([2, 10, 10000])
Most likely next token batch 1: 8541
Most likely next token batch 2: 9261
```

## Task 12

**Description:**

Implement a full encoder-decoder Transformer, including modifications to all needed layers. Apply it on the following input:

```python
input_ids = [[6044, 8239, 4933, 3760, 8963, 8379, 5427, 8503, 3497, 5683],
        [4101, 6866, 2756, 1399, 5878,  376,   56, 9868, 8794, 6033]]
```

Set the:

- vocabulary size to $10,000$;
- embedding dimension to $512$;
- number of decoder layers to $6$;
- number of attention heads to $8$;
- hidden dimension of the feed-forward layer to $2,048$;
- dropout rate to $0.1$;
- maximum sequence length to $20$.

Output:

- the result;
- the shape of the result.

Set the seed of PyTorch to `123`.

**Acceptance criteria:**

1. An encoder-decoder transformer is implemented as discussed in `notes.md` and as shown in the Transformer paper.
2. The test case passes.
3. A seed is set for reproducibility.
4. All outputs to the console shown in the test case are present.

**Test case:**

```console
python task12.py
```

```console
tensor([[[ -9.2033,  -9.9001,  -9.5924,  ..., -10.1276,  -9.2756,  -8.9413],
         [ -9.0466,  -9.7575,  -9.6736,  ..., -10.2279,  -9.3086,  -9.1587],
         [ -9.0085,  -9.6970,  -9.5427,  ...,  -9.9432,  -9.2422,  -9.1089],
         ...,
         [ -9.1137,  -9.7337,  -9.6445,  ...,  -9.8469,  -9.3761,  -9.0421],
         [ -8.8881,  -9.6545,  -9.6049,  ...,  -9.8575,  -9.3351,  -9.0694],
         [ -9.2042,  -9.7282,  -9.5689,  ..., -10.1149,  -9.4575,  -9.1909]],

        [[ -9.4579,  -9.1681,  -9.1146,  ..., -10.3198,  -9.3271,  -8.9093],
         [ -9.5179,  -9.4810,  -9.1067,  ..., -10.2179,  -9.2605,  -8.8118],
         [ -9.6158,  -9.3932,  -9.2662,  ..., -10.2454,  -9.4154,  -9.0224],
         ...,
         [ -9.5854,  -9.3950,  -9.4442,  ..., -10.1514,  -9.5068,  -8.9393],
         [ -9.6096,  -9.3305,  -9.3257,  ..., -10.2168,  -9.4237,  -8.9082],
         [ -9.4215,  -9.3242,  -9.4164,  ..., -10.0418,  -9.3880,  -8.8484]]],
       grad_fn=<LogSoftmaxBackward0>)
torch.Size([2, 10, 10000])
```
